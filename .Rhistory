devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(Capr)
install.packages("/home/martin/Documents/github/Capr_0.0.1.994.tar.gz", type = "source", repos = NULL)
library(Capr)
usethis::use_testthat()
library(Capr)
StartWindow1 <- createWindow(StartDays = 21, StartCoeff = "Before",
EndDays = "All",EndCoeff = "After")
StartWindow1
# check values in object are set
expect_equal("IndexStartDate", StartWindow1@Index)
library(testthat)
# check values in object are set
expect_equal("IndexStartDate", StartWindow1@Index)
expect_equal(21L, StartWindow1@Start$Days)
?expect_equal
library(devtools)
library(roxygen2)
document()
document()
Sys.getenv("CDM5_POSTGRESQL_SERVER")
sample(1:3,1)
sample(1:3,1)
?Sys.setenv
Sys.getenv()
Sys.setenv(
CDM5_POSTGRESQL_USER = 'ohdsi',
CDM5_POSTGRESQL_PASSWORD = "1fd859ac248A2a74592e256D",
CDM5_POSTGRESQL_SERVER = 'pgsqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com/vocabularyv5',
CDM5_POSTGRESQL_CDM_SCHEMA = 'cdmv5',
CDM5_POSTGRESQL_OHDSI_SCHEMA = 'ohdsi',
CDM5_SQL_SERVER_USER = 'ohdsi',
CDM5_SQL_SERVER_PASSWORD = "1fd859ac248A2a74592e256D",
CDM5_SQL_SERVER_SERVER = 'mssqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com',
CDM5_SQL_SERVER_CDM_SCHEMA = 'cdmv5.dbo',
CDM5_SQL_SERVER_OHDSI_SCHEMA = 'ohdsi.dbo',
CDM5_ORACLE_USER = 'OHDSI',
CDM5_ORACLE_PASSWORD = "1fd859ac248A2a74592e256D",
CDM5_ORACLE_SERVER = 'orasqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com/ORCL',
CDM5_ORACLE_CDM_SCHEMA = 'CDMV5',
CDM5_ORACLE_OHDSI_SCHEMA = 'OHDSI',
)
Sys.setenv(CDM5_POSTGRESQL_USER = 'ohdsi')
Sys.setenv(CDM5_POSTGRESQL_USER = 'ohdsi')
Sys.setenv(CDM5_POSTGRESQL_PASSWORD = "1fd859ac248A2a74592e256D")
Sys.setenv(CDM5_POSTGRESQL_SERVER = 'pgsqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com/vocabularyv5')
Sys.setenv(CDM5_POSTGRESQL_CDM_SCHEMA = 'cdmv5')
Sys.setenv(CDM5_POSTGRESQL_OHDSI_SCHEMA = 'ohdsi')
Sys.setenv(CDM5_SQL_SERVER_USER = 'ohdsi')
Sys.setenv(CDM5_SQL_SERVER_PASSWORD = "1fd859ac248A2a74592e256D")
Sys.setenv(CDM5_SQL_SERVER_SERVER = 'mssqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com')
Sys.setenv(CDM5_SQL_SERVER_CDM_SCHEMA = 'cdmv5.dbo')
Sys.setenv(CDM5_SQL_SERVER_OHDSI_SCHEMA = 'ohdsi.dbo')
Sys.setenv(CDM5_ORACLE_USER = 'OHDSI')
Sys.setenv(CDM5_ORACLE_PASSWORD = "1fd859ac248A2a74592e256D")
Sys.setenv(CDM5_ORACLE_SERVER = 'orasqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com/ORCL')
Sys.setenv(CDM5_ORACLE_CDM_SCHEMA = 'CDMV5')
Sys.setenv(CDM5_ORACLE_OHDSI_SCHEMA = 'OHDSI')
library(devtools)
library(roxygen2)
document()
library(Capr)
DateAtt <- createOccurrenceStartDateAttribute(Op = "bt", Value = "2016-01-01",
Extent = "2019-12-31")
str(DateAtt)
is(AgeAtt)
AgeAtt <- createAgeAttribute(Op = "gte", Value = 18L)
is(AgeAtt)
is(AgeAtt@CriteriaExpression[[1]])
str(AgeAtt)
is((AgeAtt@CriteriaExpression[[1]])
)
componentType(AgeAtt)
is(DateAtt@CriteriaExpression[[1]])
str(DateAtt)
str(AgeAtt)
?expect_equal
Sys.getenv()
library(devtools)
library(roxygen2)
document()
Sys.getenv()
# Download the JDBC drivers used in the tests
oldJarFolder <- Sys.getenv("DATABASECONNECTOR_JAR_FOLDER")
Sys.setenv("DATABASECONNECTOR_JAR_FOLDER" = tempfile("jdbcDrivers"))
downloadJdbcDrivers("postgresql")
downloadJdbcDrivers("sql server")
downloadJdbcDrivers("oracle")
#set up save space for capr
Sys.setenv("Capr_Save_Space" = tempdir("saveCapr"))
withr::defer({
#remove temp files for database connector
unlink(Sys.getenv("DATABASECONNECTOR_JAR_FOLDER"), recursive = TRUE, force = TRUE)
Sys.setenv("DATABASECONNECTOR_JAR_FOLDER" = oldJarFolder)
#remove temp dir for Capr Save space used for testing
unlink(Sys.getenv("Capr_Save_Space"), recursive = TRUE, force = TRUE)
}, testthat::teardown_env())
oldJarFolder <- Sys.getenv("DATABASECONNECTOR_JAR_FOLDER")
Sys.setenv("DATABASECONNECTOR_JAR_FOLDER" = tempfile("jdbcDrivers"))
downloadJdbcDrivers("postgresql")
downloadJdbcDrivers("sql server")
downloadJdbcDrivers("oracle")
#set up save space for capr
Sys.setenv("Capr_Save_Space" = tempdir("saveCapr"))
Sys.getenv()
Sys.setenv(CDM5_SQL_SERVER_CDM_SCHEMA = 'cdmv5.dbo')
Sys.getenv("CDM5_POSTGRESQL_SERVER")
Sys.setenv(CDM5_SQL_SERVER_OHDSI_SCHEMA = 'ohdsi.dbo')
Sys.setenv(CDM5_POSTGRESQL_USER = 'ohdsi')
Sys.setenv(CDM5_POSTGRESQL_PASSWORD = "1fd859ac248A2a74592e256D")
Sys.setenv(CDM5_POSTGRESQL_SERVER = 'pgsqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com/vocabularyv5')
Sys.setenv(CDM5_POSTGRESQL_CDM_SCHEMA = 'cdmv5')
Sys.setenv(CDM5_POSTGRESQL_OHDSI_SCHEMA = 'ohdsi')
Sys.setenv(CDM5_SQL_SERVER_USER = 'ohdsi')
Sys.setenv(CDM5_SQL_SERVER_PASSWORD = "1fd859ac248A2a74592e256D")
Sys.setenv(CDM5_SQL_SERVER_SERVER = 'mssqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com')
Sys.setenv(CDM5_SQL_SERVER_CDM_SCHEMA = 'cdmv5.dbo')
Sys.setenv(CDM5_SQL_SERVER_OHDSI_SCHEMA = 'ohdsi.dbo')
Sys.setenv(CDM5_ORACLE_USER = 'OHDSI')
Sys.setenv(CDM5_ORACLE_PASSWORD = "1fd859ac248A2a74592e256D")
Sys.setenv(CDM5_ORACLE_SERVER = 'orasqltest.cqnqzwtn5s1q.us-east-1.rds.amazonaws.com/ORCL')
Sys.setenv(CDM5_ORACLE_CDM_SCHEMA = 'CDMV5')
Sys.setenv(CDM5_ORACLE_OHDSI_SCHEMA = 'OHDSI')
document()
document()
